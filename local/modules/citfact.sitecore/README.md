## Модуль ядра сайта


https://git.studiofact.ru/citfact/citfact.sitecore


Добавляет в меню пункт Студия «Факт» с примером страницы админки.

Содержит класс-синглтон \Citfact\Sitecore\Core.


#### Citfact\SiteCore\Core
Класс Core является синглтоном и служит для получения и хранения информации, не меняющейся на протяжении жизненного цикла страницы.


#### Система хранения ID инфоблоков
С помощью метода `getIblockId` можно легко получить ID-инфоблока, без дополнительной нагрузки на систему.

ID инфоблоков хранятся в файле `/local/php_interface/constants.dat` в формате `{"IBLOCK_CODE":"IBLOCK_ID"}`.

Система хранения ID инфоблоков успешно работает в условиях несовпадения ID инфоблоков на тестовом и боевом сайтах.

Алгоритм работы:
- Метод `$core->getIblockId($core::IBLOCK_CODE_CATALOG)` принимает на вход код инфоблока, ID которого нужно получить. На сайте lsr.ru коды инфоблоков хранятся в константах класса Core.
- При вызове метода `$core->getIblockId($core::IBLOCK_CODE_CATALOG)` происходит обращение к файлу `/local/php_interface/constants.dat`, и проверка на наличие в этом файле интересующего нас кода инфоблока.
- Если значение присутствует в файле, то метод возвращает ID инфоблока без дополнительных запросов.
- Если значение отсутствует в файле, то метод выполняет запрос к базе данных, выбирая инфоблок по заданному коду инфоблока. После этого полученная пара `{"IBLOCK_CODE":"IBLOCK_ID"}` записывается в файл, и метод возвращает найденный ID инфоблока.
